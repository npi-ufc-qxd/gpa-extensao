<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="base/base">


<meta th:name="_csrf" th:content="${_csrf.token}" />
<meta th:name="_csrf_header" th:content="${_csrf.headerName}" />


<head>
<title>Extensão - Detalhes</title>
</head>

<div class="container-fluid" layout:fragment="conteudo">
	<br />

	<!-- Linha do tempo -->
	<div class="row">
		<div class="col-xs-12">
			<div
				th:replace="acao/detalhes/detalhes-linha-do-tempo :: linhadotempo"></div>

			<div th:if="${message}" class="col-lg-3 col-sm-6 col-xs-12">
				<div
					class="myadmin-alert myadmin-alert-icon myadmin-alert-click alert-success myadmin-alert-top alerttop">
					<i class="ti-check"></i> O número de bolsas foi inserido com
					sucesso! <a href="#" class="closed">&times;</a>
				</div>
			</div>
			<div th:if="${message == false}" class="col-lg-3 col-sm-6 col-xs-12">
				<div
					class="myadmin-alert myadmin-alert-icon myadmin-alert-click alert-danger myadmin-alert-top alerttop">
					<i class="ti-alert"></i> Não é possível adicionar mais bolsas do
					que foi solicitada! <a href="#" class="closed">&times;</a>
				</div>
			</div>
		</div>
	</div>

	<!-- Dados Básicos -->
	<div class="row">
		<div class="col-xs-12">
			<div
				th:replace="acao/detalhes/detalhes-dados-basicos :: dados-basicos"></div>
		</div>
	</div>
	<br />


	<div th:if="${message}" class="col-lg-3 col-sm-6 col-xs-12">
		<div
			class="myadmin-alert myadmin-alert-icon myadmin-alert-click alert-success myadmin-alert-top alerttop">
			<i class="ti-check"></i> O número de bolsas foi inserido com sucesso!
			<a href="#" class="closed">&times;</a>
		</div>
	</div>

	<div th:if="${message == false}" class="col-lg-3 col-sm-6 col-xs-12">
		<div
			class="myadmin-alert myadmin-alert-icon myadmin-alert-click alert-danger myadmin-alert-top alerttop">
			<i class="ti-alert"></i> Não é possível adicionar mais bolsas do que
			foi solicitada! <a href="#" class="closed">&times;</a>
		</div>
	</div>

	<br />

	<!-- Equipe de Trabalho -->
	<div class="row">
		<div class="col-xs-12">
			<div th:replace="acao/detalhes/detalhes-equipe :: equipe"></div>

			<!-- Parcerias -->
			<div class="row">
				<div class="col-xs-12">
					<div th:replace="acao/detalhes/detalhes-parcerias :: parcerias"></div>

				</div>
			</div>

			<!-- Pareceres -->
			<div class="row">
				<!-- Parecer Técnico -->
				<div class="col-xs-6">
					<div
						th:replace="acao/detalhes/detalhes-parecer-tecnico :: parecer-tecnico"></div>
				</div>
				<!-- Parecer do Relator -->
				<div class="col-xs-6">
					<div
						th:replace="acao/detalhes/detalhes-parecer-relator :: parecer-relator"></div>
				</div>
			</div>

		</div>
	</div>
</div>
<section layout:fragment="js">
	<script th:src="@{/js/mask.js}"></script>
	<script>
		$('#menu-acoes a').addClass("active");
		$('#equipe,#parcerias')
				.dataTable(
						{
							language : {
								"url" : "//cdn.datatables.net/plug-ins/1.10.13/i18n/Portuguese-Brasil.json"
							},
							paging : false,
							searching : false,
							info : false,
							order : [ [ 0, "asc" ] ]
						});
	</script>

	<script type="text/javascript">
		$('#instituicao').change(function() {
			if (this.value == "UFC") {
				document.getElementById("nomeInstituicao").disabled = true;
			} else {
				document.getElementById("nomeInstituicao").disabled = false;
			}
		});
	</script>

	<script type="text/javascript">
		$('#funcao')
				.change(
						function() {
							if (this.value == "OUTRA") {
								document.getElementById("participanteServidor").disabled = true;
								document.getElementById("nomeParticipante").disabled = false;
								document.getElementById("cpfParticipante").disabled = false;
								document.getElementById("descricaoFuncao").disabled = false;

							} else {
								document.getElementById("participanteServidor").disabled = false;
								document.getElementById("nomeParticipante").disabled = true;
								document.getElementById("cpfParticipante").disabled = true;
								document.getElementById("descricaoFuncao").disabled = true;
							}
						});
	</script>

	<script type="text/javascript">
		var token = $("meta[name='_csrf']").attr("content");
		var header = $("meta[name='_csrf_header']").attr("content");
		$.ajax({url : "/servidores/funcao/servidor",
				contentType : "application/json",
				type : "GET",
				data : JSON.stringify(this.value),
				beforeSend : function(xhr) {
						xhr
								.setRequestHeader("Content-Type",
										"application/json");
						xhr.setRequestHeader(header, token);
					},
					success : function(data) {
						$('#participanteServidor').empty();
						$.each(data, function(key, value) {
							$('#participanteServidor').append(
									'<option value="' + value.pessoa.id + '">'
											+ value.pessoa.nome + '</option>');
						});
					}
				});

		$('#funcao').change(function() {
			$.ajax({
				type:"GET",
				data: {funcao : this.value},
				 beforeSend: function (request)
		         {
		                request.setRequestHeader(header, token);
		            },
				url: "/participacao/buscarServidores",
				contentType: 'application/json',
				success : function(data) {
					$('#participanteServidor').empty();
					$.each(data, function(key, value) {
						$('#participanteServidor').append(
								'<option value="' + value.pessoa.id + '">'
										+ value.pessoa.nome + '</option>');
					});
				}
			});
		

		});
	</script>

	<script>
		$('#menu-acoes a').addClass("active");
		$('#equipe,#parcerias')
				.dataTable(
						{
							language : {
								"url" : "//cdn.datatables.net/plug-ins/1.10.13/i18n/Portuguese-Brasil.json"
							},
							paging : false,
							searching : false,
							info : false,
							order : [ [ 0, "asc" ] ]
						});

		$(".myadmin-alert .closed").click(function(event) {
			$(this).parents(".myadmin-alert").fadeToggle(350);

			return false;

		$('#novoParcitipante').click(function() {
			document.getElementById("nomeParceiro").disabled = false;
			document.getElementById("tipoParceiro").disabled = false;
			document.getElementById("parceiro").disabled = true;

		});
		$('#parcitipanteExistente').click(function() {
			document.getElementById("parceiro").disabled = false;
			document.getElementById("nomeParceiro").disabled = true;
			document.getElementById("tipoParceiro").disabled = true;
		});
		$('#outrasFormas')
				.click(
						function() {
							if (document.getElementById("outrasFormas").checked) {
								document
										.getElementById("descricaoOutrasFormas").disabled = false;
							} else {
								document
										.getElementById("descricaoOutrasFormas").disabled = true;
							}

						});
	</script>

	<script type="text/javascript">
		var checkboxes = $("input[type='checkbox']"), btnAdicionar = $('#adcParceria');

		checkboxes.click(function() {
			btnAdicionar.attr("disabled", !checkboxes.is(":checked"));
		});

		$(".myadmin-alert .closed").click(function(event) {
			$(this).parents(".myadmin-alert").fadeToggle(350);

			return false;
		});

		$(".showtop").ready(function() {
			$(".alerttop").fadeToggle(350);
		});
	</script>
	<script type="text/javascript">
		$('#modal_exclusao_bolsa').on('show.bs.modal', function (e) {
		  var $elementoQueInvocouModal = $(e.relatedTarget);
		  var link = $elementoQueInvocouModal.attr('link_exclusao');
		  var a = document.getElementById('btn_confirmacao_exclusao_bolsista');
		  a.href = link;
		});
		$('#modal_exclusao_participacao').on('show.bs.modal', function (e) {
			  var $elementoQueInvocouModal = $(e.relatedTarget);
			  var link = $elementoQueInvocouModal.attr('link_exclusao');
			  var a = document.getElementById('btn_confirmacao_exclusao_participacao');
			  a.href = link;
		});
		
		$('#modal_alterar_periodo_participante').on('show.bs.modal', function (e) {
			  var $elementoQueInvocouModal = $(e.relatedTarget);
			  var participacao = $elementoQueInvocouModal.attr('participacao');
			  var linkAlteracaoParticipacao =  $elementoQueInvocouModal.attr('link_alteracao');
			  var form = document.getElementById('alterar_periodo_participante');
			  var token = $("meta[name='_csrf']").attr("content");
			  var header = $("meta[name='_csrf_header']").attr("content");
			  form.action = linkAlteracaoParticipacao;
			  $.ajax({
					type:"GET",
					data: {participacao : participacao},
					beforeSend: function (request){
			                request.setRequestHeader(header, token);
			        },
					url: "/participacao/buscar",
					contentType: 'application/json',
					success : function(data) {
						form.object = data;
						var nomeParticipanteAlteracaoPeriodo = document.getElementById('nomeParticipanteAlteracaoPeriodo');
						var funcaoParticipanteAlteracaoPeriodo = document.getElementById('funcaoParticipanteAlteracaoPeriodo');
						var data_termino_participacao_alterar_periodo = document.getElementById('data_termino_participacao_alterar_periodo');
						var data_inicio_participacao_alterar_periodo = document.getElementById('data_inicio_participacao_alterar_periodo');
						if(data.participante != null){
							nomeParticipanteAlteracaoPeriodo.value = data.participante.nome;
						}else{
							nomeParticipanteAlteracaoPeriodo.value = data.nomeParticipante;
						}
						if(data.funcao != null){
							funcaoParticipanteAlteracaoPeriodo.value = data.funcao;	
						}else{
							funcaoParticipanteAlteracaoPeriodo.value = data.descricaoFuncao;
						}
						
						data_termino_participacao_alterar_periodo.value = data.dataTermino;
						data_inicio_participacao_alterar_periodo.value = data.dataInicio;
						
					}
				});
		});	
		
		
	</script>

	<script>
		$(".column-step").each(function(index,element) { 
			$( element ).toggleClass( "upcoming" );
			$( element ).find("i").removeClass( "fa-times" );
			$( element ).find("i").toggleClass( "fa-check" );
			if($( this ).is( ".active" ) ){
				return false;
			}
		});
	</script>
</section>
</html>
